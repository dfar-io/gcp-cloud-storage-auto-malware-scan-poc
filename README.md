# gcp-cloud-storage-auto-malware-scan-poc
POC for Automatic malware scanning for files uploaded to GCP Cloud Storage. This
repo looks to create the [Google-provided solution](https://cloud.google.com/architecture/automate-malware-scanning-for-documents-uploaded-to-cloud-storage)
using Terraform.

## Creating Infrastructure

First, create a Codespace, which comes with Terraform and gcloud installed.

```
gcloud auth application-default login
terraform init
terraform apply
```

## Scenario

1. Log into GCP Console
2. Upload a file to `malware-scanner-intake`
3. Chekc the logs for the `malware-scanner` Cloud Run container, you should see the file upload event.

## Reference

https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/eventarc_trigger
https://cloud.google.com/eventarc/docs/creating-triggers-terraform